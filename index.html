<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Flor 05 Web</title>
</head>

<body style="margin:0; background:black; display:flex; justify-content:center; align-items:center; height:100vh;">

  <canvas id="canvas" width="800" height="800"></canvas>

  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    fetch("sunflowers.json")
      .then(response => response.json())
      .then(data => {
        draw(data);
      });

    function draw(shapes) {

      // --- CALCULAR BORDES REALES ---
      let minX = Infinity, minY = Infinity;
      let maxX = -Infinity, maxY = -Infinity;

      shapes.forEach(shape => {
        shape.contour.forEach(point => {
          minX = Math.min(minX, point[0]);
          minY = Math.min(minY, point[1]);
          maxX = Math.max(maxX, point[0]);
          maxY = Math.max(maxY, point[1]);
        });
      });

      const drawingWidth = maxX - minX;
      const drawingHeight = maxY - minY;

      // Escala automÃ¡tica para que quepa en canvas
      const scale = Math.min(
        canvas.width / drawingWidth,
        canvas.height / drawingHeight
      ) * 0.9; // 0.9 para dejar margen

      ctx.save();

      // Centrar
      ctx.translate(canvas.width / 2, canvas.height / 2);
      ctx.scale(scale, scale);
      ctx.translate(
        -(minX + drawingWidth / 2),
        -(minY + drawingHeight / 2)
      );

      shapes.forEach(shape => {

        const r = Math.min(255, Math.max(0, Math.round(shape.color[0])));
        const g = Math.min(255, Math.max(0, Math.round(shape.color[1])));
        const b = Math.min(255, Math.max(0, Math.round(shape.color[2])));

        ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;

        ctx.beginPath();

        shape.contour.forEach((point, index) => {
          if (index === 0) {
            ctx.moveTo(point[0], point[1]);
          } else {
            ctx.lineTo(point[0], point[1]);
          }
        });

        ctx.closePath();
        ctx.fill();
      });

      ctx.restore();
    }
  </script>

</body>
</html>
